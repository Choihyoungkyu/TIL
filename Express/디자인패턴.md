# Express 디자인 패턴

- Node.js 상에서 구동되는 서버 프레임워크
- MVC 패턴을 사용
- 많은 Method 및 Middleware를 통해 쉬운 API 작성



#### 디자인패턴 사용 이유

- 유지보수, 가독성, 효율적인 코드 작성의 이점
- 코드의 중복을 피해주며 안정성이 높아져 유지보수에 도움이 됨



#### MVC 패턴 장점

- 염려의 분리
  - 각각의 layer가 하는 역할이 명확하므로 문제 발생시 요인 지점을 빠르게 확인 가능
- 동시적인 개발
  - 정해진 protocol만 있으면 각 layer는 독자적으로 개발이 가능
- 수정이 용이
  - 하나의 layer가 수정되어야 할 상황이 발생해도 다른 layer에 영향을 주지 않음
- 테스트-주도 개발
  - layer가 분리되어 있으므로 각 layer별 테스트가 용이



## MVC 패턴

<img src="./images/mvc.PNG" alt="mvc pattern" style="zoom:50%;" />

#### Model

- 모델은 클라이언트에 노출되지 않는다
- 연산처리 및 DB 처리가 주 목적
- `service`에서 요청이 들어오면 해당 연산처리 후 정보를 `return`한다



#### View

- 클라이언트에 나타나는 부분
- HTML / CSS / Javascript 등으로 꾸미고, 움직이고, 표현하는게 가능
- 사용자에게 보여지는 반드시 필요한 부분으로, 가공된 정보를 사용자가 보기 쉽게 나타내야 하는 곳



#### Controller

- 사용자의 요청을 받고 응답을 해준다
- 데이터 가공이 이뤄지는 곳
- `Model`과 `View` 사이의 과정이 모두 이뤄진다



> `View` 요청 -> `Model` 연산 -> 가공된 데이터 -> `View` 응답



#### Express MVC

```
|-- app.js										# 실행 주체
|-- package.json							# yarn 패키지 관리
|-- yarn.lock									# yarn 패키지 잠금
|-- src												# 소스 폴더
		|-- modules									# 사용자 지정 모듈
		|-- routes									# 요청에 따른 분리
		|-- controllers							# API 요청/응답 실행
		|-- services								# 데이터 가공
		|-- repository							# DB CRUD
		|-- entities								# Model과 동일
```

- 로직은 `routes` -> `controllers` -> `services` -> `repository` 로 분리
- `routes` : API 요청에 따른 라우팅
- `controllers` : API 요청/응답에 관한 로직만 작성 (비즈니스 로직은 X)
- `repository` : 데이터베이스에서 기본적인 CRUD 작업을 하며 정제되지 않은 데이터를 반환
- `services` : 비즈니스 로직 담당, 데이터 가공 후 `controllers`에 반환해줌



## 절대 경로 / 상대 경로

`package.json`

```typescript
"_moduleAlias": {
  "@routes/*": "./dist/routes/*",
  "@controllers/*": "./dist/controllers/*",
  "@services/*": "./dist/services/*",
  "@repository/*": "./dish/repository/*",
  "@entities/*": "./dist/entities/*",
  "@modules/*": "./dist/modules/*"
}
```



